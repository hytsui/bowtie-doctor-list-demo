{"version":3,"sources":["utils/data.js","api/doctors.js","config.js","store.js","components/Picker.js","components/SearchPanel.js","components/DoctorCard.js","components/DoctorList.js","theme.js","App.js","serviceWorker.js","index.js"],"names":["mapServiceType","serviceType","HER","PHY","ACU","BST","SPL","PHS","ROE","CHI","SPO","removeBlankItems","array","_filter","item","_isEmpty","fetchDoctorList","axios","get","ROOT_PATH","then","data","Promise","resolve","parse","from_line","err","output","result","_map","row","id","name","serviceTypes","split","region","location","address","tel","openDays","_join","prices","medicine","parseCsvData","DoctorListContext","createContext","StoreProvider","children","useState","loading","setLoading","regionOptions","setRegionOptions","locationFilters","setLocationFilters","fullList","setFullList","useEffect","doctors","groups","locations","_forEach","doctor","push","getRegions","contextValue","Provider","value","useLocationFilters","useContext","filter","newFilters","_includes","f","concat","PickerContainer","styled","div","PickerOption","props","theme","pickerHover","pickerActive","Picker","className","items","values","onSelect","key","onClick","propTyeps","PropTypes","string","arrayOf","func","PanelContainer","shadow","panelBorder","panelText","panelBg","Underlay","active","SearchWrapper","SearchContainer","expand","PickersContainer","RegionPicker","LocationPicker","panelSeparator","FilterList","FilterHint","span","panelHint","Filter","FilterTag","tagBg","tagText","SearchPanel","toggleFilter","regions","setExpand","setRegion","onMouseEnter","onTouchStart","length","locationFilter","Object","keys","val","Card","cardBg","cardBorder","cardText","cardShadow","CardHeader","DoctorName","CardButton","ServiceList","ContactInfos","ServiceTag","DoctorAddress","a","DoctorInfo","Icon","DoctorCard","useMemo","navigator","share","title","text","clipboard","writeText","href","encodeURI","target","price","index","labelPrefix","openDay","replace","ListContainer","appBg","CardListWrapper","CardList","Pager","PagerButton","disabled","panelDisabledText","CardWrapper","DoctorList","page","setPage","pageSize","pageItems","_slice","totalPages","Math","ceil","useDoctorList","filters","max","min","App","Boolean","window","hostname","match","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.cab781c0.chunk.js","sourcesContent":["import _map from 'lodash/map'\r\nimport _filter from 'lodash/filter'\r\nimport _forEach from 'lodash/forEach'\r\nimport _isEmpty from 'lodash/isEmpty'\r\nimport _join from 'lodash/join'\r\nimport parse from 'csv-parse'\r\n\r\n/**\r\n * Removes special characters at the end of the string.\r\n * @param {string} text\r\n */\r\nexport function trimSpecialChars(text) {\r\n  return text.replace(/[,:;]*$/, '')\r\n}\r\n\r\n/**\r\n * Gets the link to google map for the location.\r\n * @param {string} location\r\n */\r\nexport function getLocationLink(location) {\r\n  return `https://maps.google.com/?q=${encodeURI(location)}`\r\n}\r\n\r\n/**\r\n * Returns the label for service type code.\r\n * @param {string} serviceType\r\n */\r\nexport function mapServiceType(serviceType) {\r\n  return {\r\n    HER: '中醫',\r\n    PHY: '普通科門診',\r\n    ACU: '針灸',\r\n    BST: '跌打',\r\n    SPL: '腸胃肝臟科專科',\r\n    PHS: '物理治療',\r\n    ROE: '牙科',\r\n    CHI: '脊醫',\r\n    SPO: '運動治療',\r\n  }[serviceType]\r\n}\r\n\r\n/**\r\n * Removes empty items from the array.\r\n * @param {array} array\r\n */\r\nexport function removeBlankItems(array) {\r\n  return _filter(array, item => !_isEmpty(item))\r\n}\r\n\r\n/**\r\n * Gets all regions and locations from the doctor list and returns a map to the list of locations.\r\n * @param {array} doctors\r\n * @returns map of region -> array of locations\r\n */\r\nexport function getRegions(doctors) {\r\n  const groups = {}\r\n  const locations = {}\r\n  _forEach(doctors, doctor => {\r\n    if (!locations[doctor.location]) {\r\n      locations[doctor.location] = true\r\n\r\n      if (!groups[doctor.region]) {\r\n        groups[doctor.region] = []\r\n      }\r\n      groups[doctor.region].push(doctor.location)\r\n    }\r\n  })\r\n  return groups\r\n}\r\n\r\n/**\r\n * Parses and converts the data csv to an array of doctor objects.\r\n * @param {*} data\r\n */\r\nexport function parseCsvData(data) {\r\n  return new Promise(resolve => {\r\n    parse(data, {\r\n      from_line: 2\r\n    }, function (err, output) {\r\n      const result = _map(output, row => {\r\n        return {\r\n          id: row[3],\r\n          name: row[4],\r\n          serviceTypes: row[0].split('/'),\r\n          region: row[12],\r\n          location: row[11],\r\n          address: [\r\n            row[9],\r\n            row[10]\r\n          ],\r\n          tel: row[13],\r\n          openDays: removeBlankItems([\r\n            _join(removeBlankItems([row[23], row[24]]), ': '),\r\n            _join(removeBlankItems([row[25], row[26]]), ': '),\r\n            _join(removeBlankItems([row[27], row[28]]), ': '),\r\n            _join(removeBlankItems([row[29], row[30]]), ': '),\r\n          ]),\r\n          prices: removeBlankItems(row[31].split(',')),\r\n          medicine: removeBlankItems(row[33].split(','))\r\n        }\r\n      })\r\n      resolve(result)\r\n    })\r\n  })\r\n}\r\n","import axios from 'axios'\r\n\r\nimport { DOCTOR_LIST_CSV_PATH } from '../config'\r\nimport { parseCsvData } from '../utils/data'\r\n\r\nexport function fetchDoctorList() {\r\n  return axios.get(DOCTOR_LIST_CSV_PATH).then(({ data }) => parseCsvData(data))\r\n}\r\n","export const ROOT_PATH = '/bowtie-doctor-list-demo'\r\nexport const DOCTOR_LIST_CSV_PATH = ROOT_PATH + '/doctors.csv'\r\n","import React, { createContext, useContext, useEffect, useState, useMemo } from 'react'\r\nimport _filter from 'lodash/filter'\r\nimport _isEmpty from 'lodash/isEmpty'\r\nimport _includes from 'lodash/includes'\r\nimport _slice from 'lodash/slice'\r\n\r\nimport { fetchDoctorList } from './api/doctors'\r\nimport { getRegions } from './utils/data'\r\n\r\nconst DoctorListContext = createContext()\r\n\r\nexport function StoreProvider({ children }) {\r\n  const [loading, setLoading] = useState(true)\r\n  const [regionOptions, setRegionOptions] = useState({})\r\n  const [locationFilters, setLocationFilters] = useState([])\r\n  const [fullList, setFullList] = useState([])\r\n\r\n  useEffect(() => {\r\n    // fetch remote doctor list on mounted\r\n    fetchDoctorList().then(doctors => {\r\n      setFullList(doctors)\r\n      setRegionOptions(getRegions(doctors))\r\n      setLoading(false)\r\n    })\r\n  }, [])\r\n\r\n  const contextValue = {\r\n    fullList,\r\n    regionOptions,\r\n    locationFilters,\r\n    setLocationFilters,\r\n    loading\r\n  }\r\n\r\n  return (\r\n    <DoctorListContext.Provider value={contextValue}>\r\n      { children }\r\n    </DoctorListContext.Provider>\r\n  )\r\n}\r\n\r\n/**\r\n * Gets the filtered doctor list of the specified page.\r\n * @param {*} page the current page number, starting at 0\r\n * @param {*} pageSize the number of items in a page\r\n * @returns [items of the page, total number of page]\r\n */\r\nexport function useDoctorList(page = 0, pageSize = 10) {\r\n  const { loading, locationFilters, fullList } = useContext(DoctorListContext)\r\n\r\n  const items = useMemo(() => {\r\n    if (_isEmpty(locationFilters)) {\r\n      return fullList // return full list if no filter is applied\r\n    }\r\n    return _filter(fullList, doctor => {\r\n      return _includes(locationFilters, doctor.location) // show a doctor if the location matches any of the filter\r\n    })\r\n  }, [locationFilters, fullList])\r\n\r\n  const pageItems = _slice(items, page * pageSize, (page + 1) * pageSize)\r\n  const totalPages = Math.ceil(items.length / pageSize)\r\n\r\n  return [loading, pageItems, totalPages]\r\n}\r\n\r\n/**\r\n * Gets the applied filters and the function to manipulate the filter list.\r\n * @returns [selectedFilters, function to toggle a filter]\r\n */\r\nexport function useLocationFilters() {\r\n  const { locationFilters, setLocationFilters } = useContext(DoctorListContext)\r\n  const toggleFilter = (filter) => {\r\n    let newFilters\r\n    if (_includes(locationFilters, filter)) {\r\n      newFilters = _filter(locationFilters, f => f !== filter)\r\n    } else {\r\n      newFilters = locationFilters.concat(filter)\r\n    }\r\n    setLocationFilters(newFilters)\r\n  }\r\n  return [locationFilters, toggleFilter]\r\n}\r\n\r\n/**\r\n * @returns available options of locations\r\n */\r\nexport function useRegions() {\r\n  const { regionOptions } = useContext(DoctorListContext)\r\n  return regionOptions\r\n}\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport styled from 'styled-components'\r\nimport _map from 'lodash/map'\r\nimport _includes from 'lodash/includes'\r\n\r\nconst PickerContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  box-sizing: border-box;\r\n  overflow: auto;\r\n`\r\n\r\nconst PickerOption = styled.div`\r\n  cursor: pointer;\r\n  margin: 2.5px;\r\n  padding: 5px 7.5px;\r\n  border-radius: 5px;\r\n  transition background 0.3s;\r\n  &:hover {\r\n    background: ${props => props.theme.pickerHover};\r\n  }\r\n  &.active {\r\n    background: ${props => props.theme.pickerActive};\r\n  }\r\n`\r\n\r\nfunction Picker({ className, items, values, onSelect }) {\r\n  return (\r\n    <PickerContainer className={className}>\r\n      {_map(items, item => (\r\n        <PickerOption\r\n          key={item}\r\n          className={_includes(values, item) ? 'active' : ''}\r\n          onClick={() => onSelect && onSelect(item)}\r\n        >\r\n          { item }\r\n        </PickerOption>\r\n      ))}\r\n    </PickerContainer>\r\n  )\r\n}\r\n\r\nPicker.propTyeps = {\r\n  className: PropTypes.string,\r\n  items: PropTypes.arrayOf(PropTypes.string),\r\n  values: PropTypes.arrayOf(PropTypes.string),\r\n  onSelect: PropTypes.func\r\n}\r\n\r\nexport default Picker\r\n","import React, { useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport _map from 'lodash/map'\r\n\r\nimport { useLocationFilters, useRegions } from '../store'\r\nimport Picker from './Picker'\r\n\r\nconst PanelContainer = styled.div`\r\n  position: sticky;\r\n  top: 0;\r\n  box-shadow: 2px 2px 6px 2px ${props => props.theme.shadow};\r\n  border-bottom: 1px solid ${props => props.theme.panelBorder};\r\n  color: ${props => props.theme.panelText};\r\n  background: ${props => props.theme.panelBg};\r\n  z-index: 1;\r\n`\r\n\r\nconst Underlay = styled.div`\r\n  position: fixed;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 1;\r\n\r\n  ${props => props.active ? '' : 'display: none;'}\r\n`\r\n\r\nconst SearchWrapper = styled.div`\r\n  position: relative;\r\n  z-index: 2;\r\n`\r\n\r\nconst SearchContainer = styled.div`\r\n  transition: height 0.3s;\r\n  overflow: hidden;\r\n  height: ${props => props.expand ? '135px' : '0'};\r\n`\r\n\r\nconst PickersContainer = styled.div`\r\n  height: 125px;\r\n  margin-bottom: 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n`\r\n\r\nconst RegionPicker = styled(Picker)`\r\n  margin-right: 5px;\r\n  @media screen and (min-width: 1024px) {\r\n    margin-right: 15px\r\n  }\r\n`\r\n\r\nconst LocationPicker = styled(Picker)`\r\n  border-left: 1px solid ${props => props.theme.panelSeparator};\r\n  padding-left: 5px;\r\n  width: 75%;\r\n  flex-direction: row;\r\n  align-items: flex-start;\r\n  flex-wrap: wrap;\r\n  @media screen and (min-width: 1024px) {\r\n    width: 50%;\r\n    padding-left: 15px;\r\n  }\r\n`\r\n\r\nconst FilterList = styled.div`\r\n  margin: 0 15px;\r\n  min-height: 42px;\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n`\r\n\r\nconst FilterHint = styled.span`\r\n  margin-left: 5px;\r\n  color: ${props => props.theme.panelHint};\r\n  flex: 1;\r\n  text-align: center;\r\n`\r\n\r\nconst Filter = styled.div`\r\n  padding: 5px;\r\n`\r\n\r\nconst FilterTag = styled.div`\r\n  cursor: pointer;\r\n  background: ${props => props.theme.tagBg};\r\n  color: ${props => props.theme.tagText};\r\n  border-radius: 20px;\r\n  padding: 5px 10px 5px 15px;\r\n  display: flex;\r\n  align-items: center;\r\n  > span.material-icons {\r\n    font-size: 18px;\r\n  }\r\n`\r\n\r\nfunction SearchPanel () {\r\n  const [locationFilters, toggleFilter] = useLocationFilters()\r\n  const regions = useRegions()\r\n  const [expand, setExpand] = useState(false)\r\n\r\n  const [region, setRegion] = useState(null) // current selection of region\r\n  const locations = regions && regions[region]\r\n\r\n  return (\r\n    <PanelContainer>\r\n      <Underlay active={expand} onMouseEnter={() => setExpand(false)} onTouchStart={() => setExpand(false)} />\r\n      <SearchWrapper onMouseEnter={() => setExpand(true)} onTouchStart={() => setExpand(true)}>\r\n        <FilterList>\r\n          <span className=\"material-icons\">search</span>\r\n          {locationFilters.length === 0 ? (\r\n            <FilterHint>按地區搜索</FilterHint>\r\n          ) : (\r\n            _map(locationFilters, locationFilter => (\r\n              <Filter key={locationFilter}>\r\n                <FilterTag onClick={() => toggleFilter(locationFilter)}>\r\n                  <span>{ locationFilter }</span>\r\n                  <span className=\"material-icons\">close</span>\r\n                </FilterTag>\r\n              </Filter>\r\n            ))\r\n          )}\r\n        </FilterList>\r\n        <SearchContainer expand={expand}>\r\n          <PickersContainer>\r\n            <RegionPicker\r\n              items={Object.keys(regions)}\r\n              values={[region]}\r\n              onSelect={val => setRegion(val)}\r\n            />\r\n            <LocationPicker\r\n              items={locations}\r\n              values={locationFilters}\r\n              onSelect={val => toggleFilter(val)}\r\n            />\r\n          </PickersContainer>\r\n        </SearchContainer>\r\n      </SearchWrapper>\r\n    </PanelContainer>\r\n  )\r\n}\r\n\r\nexport default SearchPanel\r\n","import React, { useMemo } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport styled from 'styled-components'\r\nimport _map from 'lodash/map'\r\nimport _join from 'lodash/join'\r\n\r\nimport { mapServiceType, trimSpecialChars, getLocationLink } from '../utils/data'\r\n\r\nconst Card = styled.div`\r\n  box-sizing: border-box;\r\n  background: ${props => props.theme.cardBg};\r\n  border: 1px solid ${props => props.theme.cardBorder};\r\n  color: ${props => props.theme.cardText};\r\n  padding: 10px;\r\n  border-radius: 4px;\r\n  box-shadow: 2px 4px 5px 1px ${props => props.theme.cardShadow};\r\n`\r\n\r\nconst CardHeader = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`\r\n\r\nconst DoctorName = styled.div`\r\n  flex: 1;\r\n  font-weight: bold;\r\n  font-size: 18px;\r\n`\r\n\r\nconst CardButton = styled.span`\r\n  margin-left: 10px;\r\n  cursor: pointer;\r\n  font-size: 22px;\r\n`\r\n\r\nconst ServiceList = styled.div`\r\n  margin: 0 -2.5px;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n`\r\n\r\nconst ContactInfos = styled.div`\r\n  margin: 10px 0;\r\n`\r\n\r\nconst ServiceTag = styled.div`\r\n  margin: 10px 2.5px 0 2.5px;\r\n  border: 1px solid ${props => props.theme.cardText};\r\n  padding: 5px 15px;\r\n  border-radius: 20px;\r\n  :not(:first-child) {\r\n    margin-left: 5px;\r\n  }\r\n`\r\n\r\nconst DoctorAddress = styled.a`\r\n  color: ${props => props.theme.cardText};\r\n  font-weight: bold;\r\n  text-decoration: none;\r\n  display: flex;\r\n  align-items: center;\r\n`\r\n\r\nconst DoctorInfo = styled.div`\r\n  line-height: 22px;\r\n  display: flex;\r\n  align-items: center;\r\n`\r\n\r\nconst Icon = styled.span`\r\n  font-size: 18px;\r\n`\r\n\r\nfunction DoctorCard({ doctor }) {\r\n  const address = useMemo(() => _join(doctor.address, ', '), [doctor.address])\r\n\r\n  const onShare = () => {\r\n    navigator.share({\r\n      title: doctor.name,\r\n      text: `${doctor.name}\\n地址:${address}\\n電話:${doctor.tel}`\r\n    })\r\n  }\r\n\r\n  const onCopy = () => {\r\n    navigator.clipboard.writeText(`${doctor.name}\\n地址:${address}\\n電話:${doctor.tel}`)\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <DoctorName>{ doctor.name }</DoctorName>\r\n        {navigator.share ? (\r\n          <CardButton className=\"material-icons\" onClick={onShare}>share</CardButton>\r\n        ) : null}\r\n        {navigator.clipboard ? (\r\n          <CardButton className=\"material-icons\" onClick={onCopy}>file_copy</CardButton>\r\n        ) : null}\r\n      </CardHeader>\r\n      <ServiceList>\r\n        {_map(doctor.serviceTypes, serviceType => (\r\n          <ServiceTag key={serviceType}>{ mapServiceType(serviceType) }</ServiceTag>\r\n        ))}\r\n      </ServiceList>\r\n      <ContactInfos>\r\n        <DoctorAddress href={getLocationLink(_join(doctor.address, ','))} target=\"_blank\">\r\n          <Icon className=\"material-icons\">location_on</Icon>\r\n          <span>{ address }</span>\r\n        </DoctorAddress>\r\n        <DoctorInfo>\r\n          <Icon className=\"material-icons\">local_phone</Icon>{ doctor.tel }\r\n        </DoctorInfo>\r\n      </ContactInfos>\r\n      <DoctorInfo><b>會員專享:</b></DoctorInfo>\r\n      {_map(doctor.prices, (price, index) => {\r\n        let labelPrefix = ''\r\n        if (doctor.prices.length === doctor.serviceTypes.length && doctor.prices.length > 1) {\r\n          labelPrefix = mapServiceType(doctor.serviceTypes[index])\r\n        }\r\n        let medicine = '不包括任何藥物'\r\n        if (doctor.medicine && doctor.medicine.length > index && doctor.medicine[index] !== 'NA') {\r\n          medicine = `包括${doctor.medicine[index]}日藥物`\r\n        }\r\n        return (\r\n          <DoctorInfo key={index}>\r\n            { labelPrefix }診金: ${ price } ({medicine})\r\n          </DoctorInfo>\r\n        )\r\n      })}\r\n      {_map(doctor.openDays, (openDay, index) => (\r\n        <DoctorInfo key={index}>{ trimSpecialChars(openDay) }</DoctorInfo>\r\n      ))}\r\n    </Card>\r\n  )\r\n}\r\n\r\nDoctorCard.propTypes = {\r\n  doctor: PropTypes.any\r\n}\r\n\r\nexport default DoctorCard\r\n","import React, { useState, useEffect } from 'react'\r\nimport styled from 'styled-components'\r\nimport _map from 'lodash/map'\r\n\r\nimport SearchPanel from './SearchPanel'\r\nimport DoctorCard from './DoctorCard'\r\nimport { useDoctorList, useLocationFilters } from '../store'\r\n\r\nconst ListContainer = styled.div`\r\n  min-height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background: ${props => props.theme.appBg};\r\n`\r\n\r\nconst CardListWrapper = styled.div`\r\n  flex: 1;\r\n`\r\n\r\nconst CardList = styled.div`\r\n  margin: 0 auto;\r\n  max-width: 1280px;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n`\r\n\r\nconst Pager = styled.div`\r\n  position: sticky;\r\n  bottom: 0;\r\n  box-shadow: 2px 2px 6px 2px ${props => props.theme.shadow};\r\n  color: ${props => props.theme.panelText};\r\n  background: ${props => props.theme.panelBg};\r\n  border-top: 1px solid ${props => props.theme.panelBorder};\r\n  padding: 10px 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`\r\n\r\nconst PagerButton = styled.span`\r\n  margin: 0 20px;\r\n  cursor: pointer;\r\n  ${props => props.disabled ? `color: ${props.theme.panelDisabledText};` : ''}\r\n`\r\n\r\nconst CardWrapper = styled.div`\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  padding: 15px;\r\n  > * {\r\n    height: 100%;\r\n  }\r\n  @media screen and (min-width: 1024px) {\r\n    width: 50%;\r\n    padding: 20px;\r\n  }\r\n  @media screen and (min-width: 1280px) {\r\n    width: 33.3333%;\r\n  }\r\n`\r\n\r\nexport default function DoctorList() {\r\n  const [page, setPage] = useState(0)\r\n  const [loading, doctors, totalPages] = useDoctorList(page, 12) // use 12 items per page for all layouts\r\n  const [filters] = useLocationFilters()\r\n\r\n  // reset to page 1 if filter is updated\r\n  useEffect(() => {\r\n    setPage(0)\r\n  }, [filters])\r\n\r\n  if (loading) {\r\n    return <div>Loading...</div>\r\n  }\r\n\r\n  return (\r\n    <ListContainer>\r\n      <SearchPanel />\r\n      <CardListWrapper>\r\n        <CardList>\r\n          {_map(doctors, (doctor, index) => (\r\n            <CardWrapper key={index}>\r\n              <DoctorCard doctor={doctor} />\r\n            </CardWrapper>\r\n          ))}\r\n        </CardList>\r\n      </CardListWrapper>\r\n      <Pager>\r\n        <PagerButton\r\n          className=\"material-icons\"\r\n          disabled={page === 0}\r\n          onClick={() => setPage(Math.max(0, page - 1))}\r\n        >\r\n          navigate_before\r\n        </PagerButton>\r\n        <span>第 { page + 1 } / { totalPages } 頁</span>\r\n        <PagerButton\r\n          className=\"material-icons\"\r\n          disabled={page >= totalPages - 1}\r\n          onClick={() => setPage(Math.min(totalPages - 1, page + 1))}\r\n        >\r\n          navigate_next\r\n        </PagerButton>\r\n      </Pager>\r\n    </ListContainer>\r\n  )\r\n}\r\n","\r\nconst primaryColor = '#369699'\r\nconst primaryContrast = '#E6F4F1'\r\nconst highlightColor = '#546E81'\r\nconst tertiaryColor = '#00AAB4'\r\nconst secondaryColor = '#324B4C'\r\n\r\nexport default {\r\n  appBg: primaryContrast,\r\n\r\n  panelBg: primaryColor,\r\n  panelBorder: primaryColor,\r\n  panelText: primaryContrast,\r\n  panelDisabledText: highlightColor,\r\n  panelHint: primaryContrast,\r\n  panelSeparator: primaryContrast,\r\n\r\n  pickerHover: highlightColor,\r\n  pickerActive: highlightColor,\r\n\r\n  tagBg: tertiaryColor,\r\n  tagText: primaryContrast,\r\n\r\n  cardBg: 'white',\r\n  cardShadow: '#DDDDDD',\r\n  cardBorder: primaryContrast,\r\n  cardText: secondaryColor,\r\n\r\n  shadow: 'rgba(50, 50, 50, 0.5)',\r\n\r\n}\r\n","import React from 'react'\nimport { ThemeProvider } from 'styled-components'\n\nimport DoctorList from './components/DoctorList'\nimport { StoreProvider } from './store'\nimport theme from './theme'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <ThemeProvider theme={theme}>\n        <StoreProvider>\n          <DoctorList />\n        </StoreProvider>\n      </ThemeProvider>\n    </div>\n  );\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}